// Created by Ferris on v3rmillion <3

// The code, thoroughly commented for vermie users.
var version = ""; // A variable used to store the current version (for comparing)

var request = new XMLHttpRequest(); // Initialize a new XML Http Request
request.addEventListener("load", compareVersions); // Hook the callback function
request.open("GET", "https://api.roblox.com/users/374976114/onlinestatus/"); // Open the stream as a GET request to the API
request.send(); // Send the request.

function compareVersions() { // The callback function
   if (this.responseText != version) { // Compare the stored version to the one recieved by the Request
       // The response from the request differs from our stored version!
       var hook = new XMLHttpRequest(); // Initialize a new XML Http Request
       hook.open("POST", settings.webhook_url); // Open the stream as a POST request to the webhook URL

       var hookData; // Intialize a new variable in-scope of the send function

       if (settings.message.is_embed) {
           // Build data with embed
           hookData = {
               username: settings.message.username,
               avatar_url: settings.message.avatar,
               embeds: settings.message.embeds
           };
           // If contnet is not empty, add content to hookData
           if (settings.message.content != "") hookData.content = settings.message.content;
       } else {
           // Build data without embed
           hookData = {
               username: settings.message.username,
               avatar_url: settings.message.avatar,
               content: settings.message.content
           };
       }

       hook.send(JSON.stringify(hookData)); // Send the request.
   }
}
